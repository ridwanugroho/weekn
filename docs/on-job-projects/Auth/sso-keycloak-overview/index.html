<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-on-job-projects/Auth/sso-keycloak-overview" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Single Sing On (SSO) Using Keycloak | weekn Project</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://github.com/weekn/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://github.com/weekn/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://github.com/weekn/docs/on-job-projects/Auth/sso-keycloak-overview"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Single Sing On (SSO) Using Keycloak | weekn Project"><meta data-rh="true" name="description" content="SSO is a common feature of web application. In New DNet we utilize identity provider platform called Keycloak to perform SSO. Keycloak has many ability to handle various authentication and authorization scenario but we only utilize it as identity provider. The main idea is New DNet has very custom user authorization and role management rule and it will more challenging if we rely on keycloak. Also, we are minimizing of being dependent to 3rd party platform."><meta data-rh="true" property="og:description" content="SSO is a common feature of web application. In New DNet we utilize identity provider platform called Keycloak to perform SSO. Keycloak has many ability to handle various authentication and authorization scenario but we only utilize it as identity provider. The main idea is New DNet has very custom user authorization and role management rule and it will more challenging if we rely on keycloak. Also, we are minimizing of being dependent to 3rd party platform."><link data-rh="true" rel="icon" href="/weekn/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://github.com/weekn/docs/on-job-projects/Auth/sso-keycloak-overview"><link data-rh="true" rel="alternate" href="https://github.com/weekn/docs/on-job-projects/Auth/sso-keycloak-overview" hreflang="en"><link data-rh="true" rel="alternate" href="https://github.com/weekn/docs/on-job-projects/Auth/sso-keycloak-overview" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/weekn/blog/rss.xml" title="weekn Project RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/weekn/blog/atom.xml" title="weekn Project Atom Feed"><link rel="stylesheet" href="/weekn/assets/css/styles.000e6fec.css">
<script src="/weekn/assets/js/runtime~main.65fa362d.js" defer="defer"></script>
<script src="/weekn/assets/js/main.dfdb60a4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/weekn/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/weekn/"><div class="navbar__logo"><img src="/weekn/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/weekn/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">weekn Project</b></a><a class="navbar__item navbar__link" href="/weekn/docs/home-projects/">Home Projects</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/weekn/docs/on-job-projects/Auth/sso-keycloak-overview">On Job Projects</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/weekn/docs/on-job-projects/Auth/sso-keycloak-overview">Auth</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/weekn/docs/on-job-projects/Auth/sso-keycloak-overview">Single Sing On (SSO) Using Keycloak</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/weekn/docs/on-job-projects/Auth/web-api-token-redis">Storing Web API client auth token in Redis</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/weekn/docs/on-job-projects/dealership-system/overview">dealership-system</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/weekn/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Auth</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Single Sing On (SSO) Using Keycloak</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Single Sing On (SSO) Using Keycloak</h1></header>
<p>SSO is a common feature of web application. In New DNet we utilize identity provider platform called <a href="https://www.keycloak.org/" target="_blank" rel="noopener noreferrer">Keycloak</a> to perform SSO. Keycloak has many ability to handle various authentication and authorization scenario but we only utilize it as identity provider. The main idea is New DNet has very custom user authorization and role management rule and it will more challenging if we rely on keycloak. Also, we are minimizing of being dependent to 3rd party platform.</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/weekn/assets/images/image-f17784dc2f6a2d8da4398ab0b01b42bb.png" width="531" height="450" class="img_ev3q"></p>
<p>Above is flow diagram of authenticating user to identity provider, keyloak. User, Web App, and Keycloak are communicating each other by using public domain. Here is the explanation</p>
<ol>
<li>
<p>Login : By using web browser user hit app URL. If there’s no valid cookies (either there is no cookies or invalid/expired), App will return redirection to Keycloak URL which : “Hey keycloak, please handle this user want to log into Me, once authenticate, tell me again” ← this called as point no. 2</p>
</li>
<li>
<p>App send redirection response to user. While redirecting, app set some query string in the url :</p>
<ol>
<li>Client Id</li>
<li>Redirect Url</li>
<li>response type</li>
<li>scope</li>
<li>state</li>
<li>nonce</li>
<li>code challenge</li>
<li>code challenge method</li>
</ol>
</li>
<li>
<p>User browser open keycloak URL, New DNet login page is rendered here. User submit credential to keycloak here. Here is authentication flow run in keycloak</p>
<ol>
<li>
<p>username &amp; password matching</p>
</li>
<li>
<p>check email verification status</p>
</li>
<li>
<p>check temp password state</p>
</li>
<li>
<p>check password expiration</p>
</li>
<li>
<p>MFA → TOTP Schema (FreeOtp, Google Authenticator, Microsoft Authenticator)</p>
<p>Here is the floechart</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="/weekn/assets/images/image-1-5d7fdac07ce0096f458ea05ce2edc49a.png" width="377" height="613" class="img_ev3q"></p>
</li>
</ol>
</li>
<li>
<p>Once authenticated, keycloak will redirect to app url (typically App home page). Keycloak call the /signin-oidc ulr back with datas:</p>
<ul>
<li>code : code for app to exchange token (access_token, id_token, refresh_token)</li>
<li>state : random value sent from app in point 2.e, this is used to prevent CSRF</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="password-policy">Password Policy<a href="#password-policy" class="hash-link" aria-label="Direct link to Password Policy" title="Direct link to Password Policy">​</a></h2>
<p>Keycloak also has password policy configuration.</p>
<ul>
<li>Expired password</li>
<li>Minimum length</li>
<li>Uppercase characters minimum required</li>
<li>Lowercase characters minimum required</li>
<li>Max Length</li>
<li>Special character minimum required</li>
<li>Digits minimum required</li>
<li>Not recently used count</li>
<li>Password blacklist</li>
<li>Regex</li>
<li>Not Username</li>
<li>Not email</li>
<li>Not contain username</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--next" href="/weekn/docs/on-job-projects/Auth/web-api-token-redis"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Storing Web API client auth token in Redis</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#password-policy" class="table-of-contents__link toc-highlight">Password Policy</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>